"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5470],{505:(y,C,a)=>{a.d(C,{F:()=>M});var g=a(467),s=a(9967),i=a(8455),h=a(1985),v=a(6354),t=a(1360),m=a(3522),_=a(5621),A=a(7125);let M=(()=>{var d;class f{constructor(o,r,e,n){this.firestore=o,this.authService=r,this.auth=e,this.alertController=n}obtenerContactos(){const o=this.authService.getUserId();if(o){const r=(0,s.rJ)(this.firestore,`users/${o}/contacts`),e=(0,s.P)(r);return(0,i.H)((0,s.GG)(e)).pipe((0,v.T)(n=>n.docs.map(c=>c.data())))}return new h.c}checkIfContactExists(o){var r=this;return(0,g.A)(function*(){const e=r.authService.getUserId();if(e){const n=(0,s.rJ)(r.firestore,`users/${e}/contacts`),c=(0,s.P)(n,(0,s._M)("phone","==",o));return!(yield(0,s.GG)(c)).empty}return!1})()}agregarContacto(o,r){var e=this;return(0,g.A)(function*(){const n=(0,s.rJ)(e.firestore,"users"),c=(0,s.P)(n,(0,s._M)("phone","==",o)),u=yield(0,s.GG)(c);if(u.empty)console.error("No se encontr\xf3 un usuario con ese tel\xe9fono."),e.showAlert("Contacto no encontrado","No existe un usuario con ese n\xfamero de tel\xe9fono.");else{var l;const p=u.docs[0],E=null===(l=e.auth.currentUser)||void 0===l?void 0:l.uid;if(E){const D=(0,s.H9)(e.firestore,`users/${E}/contacts/${p.id}`);yield(0,s.BN)(D,{name:r,phone:p.data().phone,userId:p.id}),console.log("Contacto agregado exitosamente."),e.showAlert("Contacto Agregado","\xa1El contacto se agreg\xf3 exitosamente!")}else console.error("No hay usuario logueado."),e.showAlert("Error","No hay usuario logueado.")}})()}getUserData(o){var r=this;return(0,g.A)(function*(){const e=(0,s.H9)(r.firestore,`users/${o}`),n=yield(0,s.x7)(e);return n.exists()?n.data():null})()}showAlert(o,r){var e=this;return(0,g.A)(function*(){yield(yield e.alertController.create({header:o,message:r,buttons:["OK"]})).present()})()}}return(d=f).\u0275fac=function(o){return new(o||d)(t.KVO(s._7),t.KVO(m.K),t.KVO(_.Nj),t.KVO(A.hG))},d.\u0275prov=t.jDH({token:d,factory:d.\u0275fac,providedIn:"root"}),f})()},5470:(y,C,a)=>{a.r(C),a.d(C,{AddContactPageModule:()=>P});var g=a(8434),s=a(4341),i=a(7125),h=a(33),v=a(467),t=a(1360),m=a(505),_=a(3522),A=a(3656);const d=[{path:"",component:(()=>{var o;class r{constructor(n,c,u){this.contactsService=n,this.authService=c,this.navCtrl=u,this.name="",this.phone=""}onSubmit(){var n=this;return(0,v.A)(function*(){n.phone&&(yield n.contactsService.agregarContacto(n.phone,n.name),n.navCtrl.navigateRoot("/home"))})()}}return(o=r).\u0275fac=function(n){return new(n||o)(t.rXU(m.F),t.rXU(_.K),t.rXU(A.q9))},o.\u0275cmp=t.VBU({type:o,selectors:[["app-add-contact"]],standalone:!1,decls:15,vars:2,consts:[["position","floating"],["type","text",3,"ngModelChange","ngModel"],["expand","full",3,"click"]],template:function(n,c){1&n&&(t.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),t.EFF(3,"Agregar Contacto"),t.k0s()()(),t.j41(4,"ion-content")(5,"ion-item")(6,"ion-label",0),t.EFF(7,"Nombre"),t.k0s(),t.j41(8,"ion-input",1),t.mxI("ngModelChange",function(l){return t.DH7(c.name,l)||(c.name=l),l}),t.k0s()(),t.j41(9,"ion-item")(10,"ion-label",0),t.EFF(11,"Tel\xe9fono"),t.k0s(),t.j41(12,"ion-input",1),t.mxI("ngModelChange",function(l){return t.DH7(c.phone,l)||(c.phone=l),l}),t.k0s()(),t.j41(13,"ion-button",2),t.bIt("click",function(){return c.onSubmit()}),t.EFF(14,"Agregar Contacto"),t.k0s()()),2&n&&(t.R7$(8),t.R50("ngModel",c.name),t.R7$(4),t.R50("ngModel",c.phone))},dependencies:[s.BC,s.vS,i.Jm,i.W9,i.eU,i.$w,i.uz,i.he,i.BC,i.ai,i.Gw],encapsulation:2}),r})()}];let f=(()=>{var o;class r{}return(o=r).\u0275fac=function(n){return new(n||o)},o.\u0275mod=t.$C({type:o}),o.\u0275inj=t.G2t({imports:[h.iI.forChild(d),h.iI]}),r})(),P=(()=>{var o;class r{}return(o=r).\u0275fac=function(n){return new(n||o)},o.\u0275mod=t.$C({type:o}),o.\u0275inj=t.G2t({imports:[g.MD,s.YN,i.bv,f]}),r})()}}]);